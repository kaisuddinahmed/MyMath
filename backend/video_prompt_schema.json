{
  "type": "object",
  "required": [
    "title",
    "grade",
    "topic",
    "problem",
    "correct_answer",
    "visual_template",
    "duration_seconds",
    "scenes",
    "checkpoint_question",
    "practice_problem"
  ],
  "properties": {
    "title": { "type": "string" },
    "grade": { "type": "integer" },
    "topic": { "type": "string" },
    "problem": { "type": "string" },
    "correct_answer": { "type": "string" },
    "visual_template": { "type": "string" },
    "duration_seconds": { "type": "integer" },

    "scenes": {
      "type": "array",
      "minItems": 3,
      "items": {
        "type": "object",
        "required": ["duration", "action", "animation_style", "narration"],
        "properties": {
          "duration": { "type": "integer", "minimum": 1 },
          "action": {
            "type": "string",
            "enum": ["ADD_ITEMS", "REMOVE_ITEMS", "GROUP_ITEMS", "SPLIT_ITEM", "SHOW_EQUATION", "HIGHLIGHT"]
          },
          "item_type": {
            "type": "string",
            "enum": ["APPLE_SVG", "BLOCK_SVG", "STAR_SVG", "COUNTER", "PIE_CHART", "BAR_CHART"]
          },
          "count": { "type": "integer", "minimum": 1 },
          "groups": { "type": "integer", "minimum": 1 },
          "per_group": { "type": "integer", "minimum": 1 },
          "numerator": { "type": "integer", "minimum": 0 },
          "denominator": { "type": "integer", "minimum": 1 },
          "equation": { "type": "string" },
          "animation_style": {
            "type": "string",
            "enum": ["BOUNCE_IN", "FADE_IN", "SLIDE_LEFT", "POP", "NONE"]
          },
          "narration": { "type": "string" }
        }
      }
    },

    "checkpoint_question": { "type": "string" },

    "practice_problem": {
      "type": "object",
      "required": ["question", "answer"],
      "properties": {
        "question": { "type": "string" },
        "answer": { "type": "string" }
      }
    }
  }
}
